(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{269:function(e,t,n){"use strict";n.r(t);n(84);var o=n(22),l=n(268),c=n.n(l),r={data:function(){return{APIKey:"d57a4c81-f9c1-46da-ac4c-727722f10a7a",selectedAudio:"",selectedVideo:"",audios:[],videos:[],localStream:null,peerId:"",calltoid:""}},mounted:function(){var e=this;this.peer=new c.a({key:this.APIKey,debug:3}),this.peer.on("open",function(){e.peerId=e.peer.id}),this.peer.on("call",function(t){t.answer(e.localStream),e.connect(t)}),navigator.mediaDevices.enumerateDevices().then(function(t){for(var i=0;i!==t.length;++i){var n=t[i];"audioinput"===n.kind?e.audios.push({text:n.label||"Microphone ".concat(e.audios.length+1),value:n.deviceId}):"videoinput"===n.kind&&e.videos.push({text:n.label||"Camera  ".concat(e.videos.length-1),value:n.deviceId})}})},methods:{onChange:function(){""!==this.selectedAudio&&""!==this.selectedVideo&&this.connectLocalCamera()},connectLocalCamera:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={audio:!!this.selectedAudio&&{deviceId:{exact:this.selectedAudio}},video:!!this.selectedVideo&&{deviceId:{exact:this.selectedVideo}}},e.next=3,navigator.mediaDevices.getUserMedia(t);case 3:n=e.sent,document.getElementById("my-video").srcObject=n,this.localStream=n;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),makeCall:function(){alert("makeCall");var e=this.peer.call(this.calltoid,this.localStream);this.connect(e)},connect:function(e){e.on("stream",function(e){var t=document.getElementById("their-video");t.srcObject=e,t.play()})}}},d=n(44),component=Object(d.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"container"},[n("div",[n("video",{attrs:{id:"their-video",width:"200",autoplay:"",playsinline:""}}),e._v(" "),n("video",{attrs:{id:"my-video",muted:"true",width:"200",autoplay:"",playsinline:""},domProps:{muted:!0}}),e._v(" "),n("div",{staticClass:"main"},[n("h2",[e._v("Nuxt.js + SkyWayのビデオチャット")]),e._v("\n      マイク:\n      "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedAudio,expression:"selectedAudio"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedAudio=t.target.multiple?n:n[0]},e.onChange]}},[n("option",{attrs:{disabled:"",value:""}},[e._v("Please select one")]),e._v(" "),e._l(e.audios,function(audio,t,o){return n("option",{key:o,domProps:{value:audio.value}},[e._v("\n          "+e._s(audio.text)+"\n        ")])})],2),e._v("\n\n      カメラ:\n      "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedVideo,expression:"selectedVideo"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedVideo=t.target.multiple?n:n[0]},e.onChange]}},[n("option",{attrs:{disabled:"",value:""}},[e._v("Please select one")]),e._v(" "),e._l(e.videos,function(video,t,o){return n("option",{key:o,domProps:{value:video.value}},[e._v("\n          "+e._s(video.text)+"\n        ")])})],2),e._v(" "),n("div",[n("p",[e._v("\n          Your id: "),n("span",{attrs:{id:"my-id"}},[e._v(e._s(e.peerId))])]),e._v(" "),n("p",[e._v("他のブラウザでこのIDをコールしましょう。")]),e._v(" "),n("h3",[e._v("コールする")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.calltoid,expression:"calltoid"}],attrs:{placeholder:"call id"},domProps:{value:e.calltoid},on:{input:function(t){t.target.composing||(e.calltoid=t.target.value)}}}),e._v(" "),n("button",{staticClass:"button--green",on:{click:e.makeCall}},[e._v("Call")])])])])])},[],!1,null,null,null);t.default=component.exports}}]);